/* Dada uma matriz de caracteres fornecida 
   pelo usuário, encontrar uma palavra nas 
   linhas, colunas e diagonais. */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX 100

int lerMatriz(char matriz[MAX][MAX], int l, int c) {
	int i, j;
	
	for(i = 0; i < l; i++) {
		for(j = 0; j < c; j++) {
			scanf(" %c", &matriz[i][j]);
		}
	}
}

int imprimirMatriz(char matriz[MAX][MAX], int l, int c) {
	int i, j;
	
	for(i = 0; i < l; i++) {
		for(j = 0; j < c; j++) {
			printf(" %c ", matriz[i][j]);
		}
		printf("\n");
	}
}

int encontrarNasColunas(char matriz[MAX][MAX], char palavra[MAX], int tamanho, int l, int c) {
    int i, j, k, flag, contagem = 0;

    for (j = 0; j < c; j++) { // Percorre todas as colunas
        for (i = 0; i <= l - tamanho; i++) { // Percorre as linhas até um limite seguro
            flag = 0; // Reinicia a flag para cada nova coluna
            for (k = 0; k < tamanho; k++) {
                if (matriz[i + k][j] == palavra[k]) {
                    flag++;
                }
            }
            if (flag == tamanho) {
                contagem++;
            }
        }
    }
    return contagem;
}

int encontrarNasLinhas(char matriz[MAX][MAX], char palavra[MAX], int tamanho, int l, int c) {
    int i, j, k, flag, contagem = 0;

    for (j = 0; j < c; j++) { // Percorre todas as colunas
        for (i = 0; i <= l - tamanho; i++) { // Percorre as linhas até um limite seguro
            flag = 0; // Reinicia a flag para cada nova coluna
            for (k = 0; k < tamanho; k++) {
                if (matriz[j][i + k] == palavra[k]) {
                    flag++;
                }
            }
            if (flag == tamanho) {
                contagem++;
            }
        }
    }
    return contagem;
}

int encontrarNasDiagonais(char matriz[MAX][MAX], char palavra[MAX], int tamanho, int l, int c) {
    int i, j, k, z, flag, contagem = 0;

    for (j = 0; j <= c - tamanho; j++) { // Percorre as colunas até um limite seguro
        for (i = 0; i <= l - tamanho; i++) { // Percorre as linhas até um limite seguro
            flag = 0; // Reinicia a flag para cada nova coluna
            for (k = 0, z = 0; k < tamanho; k++, z++) {
                if (matriz[j + k][i + z] == palavra[k]) {
                    flag++;
                }
            }
            if (flag == tamanho) {
                contagem++;
            }
        }
    }
    
    for (j = 0; j <= c - tamanho; j++) {
        for (i = tamanho - 1; i < l; i++) {
            flag = 0;
            for (k = 0; k < tamanho; k++) {
                if (matriz[i - k][j + k] == palavra[k]) {
                    flag++;
                }
            }
            if (flag == tamanho) {
                contagem++;
            }
        }
    }
    
    return contagem;
}

int main() {
	char matriz[MAX][MAX], palavra[MAX];
	int linhas = 3, colunas = 2, tamanho;
	
	/*printf("Numero de linhas da matriz: ")
	scanf("%d", &linhas)
	printf("Numero de colunas da matriz: ")
	scanf("%d", &colunas)*/
	
	fgets(palavra, MAX, stdin);
	tamanho = strlen(palavra)-1;
	
	lerMatriz(matriz, linhas, colunas);
	imprimirMatriz(matriz, linhas, colunas);
	
	printf("\n\n    Colunas: %d vez(es)", encontrarNasColunas(matriz, palavra, tamanho, linhas, colunas));
	printf("\n    Linhas: %d vez(es)", encontrarNasLinhas(matriz, palavra, tamanho, linhas, colunas));
	printf("\n    Diagonais: %d vez(es)", encontrarNasDiagonais(matriz, palavra, tamanho, linhas, colunas));
}
